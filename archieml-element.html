<!--
Archie ML parser
created 2015-09-21
Â© Copyright 2015 The Kansas City Star. All Rights Reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="archieml-import.html">

<dom-module id="archieml-element">
  <template>
    <style>
      :host {
        display: none;
      }
    </style>

    <content select=".archieml-html"></content>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'archieml-element',

    properties: {
      archieml: {
        type: String,
        observer: 'load'
      },

      value: {
        type: Object,
        notify: true
      }
    },

    ready: function() {
      if(!this.archieml) {
        var archiemlElement = Polymer.dom(this).querySelector('[type^="text/archieml"]');
        if(archiemlElement) {
          this.archieml = archiemlElement.textContent;
        }
      }
    },

    attached: {
      this._attached = true;
      this.load();
    },

    detached: {
      this._attached = false;
    },

    load: function() {
      if(!this._attached) return;
      if(!this.archieml) return;

      this.value = archieml.load(this.archieml);
    }
  });
</script>
